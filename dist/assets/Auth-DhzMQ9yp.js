import{j as e}from"./ui-BvjJb9v9.js";import{r as n}from"./vendor-CwEH9sB7.js";import{c as L,N as q}from"./router-BLvl1Ppa.js";import{a as f,u as P,I as c,U as z,B as k}from"./index-DWFjMhTV.js";import{A as E,a as D,L as d,H as B,P as H}from"./alert-BK0oGpQ8.js";import{C as O,b as U,c as G,a as V}from"./card-Dpc8cSNx.js";import{D as Y,a as R,b as W,c as J,d as K,e as Q}from"./dialog-C5dWXGR5.js";import{m as C}from"./motion-C1nvMbL4.js";import{M as Z}from"./mail--P2l9ue8.js";import{G as $}from"./graduation-cap-BUo66GRO.js";import"./query-DUFFPcPg.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=f("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=f("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=f("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=f("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),ae=({mode:r,onToggleMode:x,onSuccess:g})=>{const{signIn:j,signUp:y,loading:m}=P(),[s,h]=n.useState({email:"",password:"",confirmPassword:"",full_name:"",phone:"",department:"",student_id:""}),[u,p]=n.useState(!1),[b,a]=n.useState(null),[v,l]=n.useState(!1),[A,N]=n.useState(!1),[F,I]=n.useState(""),o=w=>{const{name:t,value:i}=w.target;h(X=>({...X,[t]:i})),a(null)},M=()=>{if(!s.email||!s.password)return a("Email and password are required"),!1;if(r==="signup"){if(s.password!==s.confirmPassword)return a("Passwords do not match"),!1;if(s.password.length<6)return a("Password must be at least 6 characters"),!1}return!0},T=async w=>{if(w.preventDefault(),!!M()){l(!0),a(null);try{if(r==="login"){const{error:t}=await j(s.email,s.password);t?(t.message.includes("security purposes")||t.message.includes("request this after")?a("Please wait a moment before trying again."):t.message.includes("Email not confirmed")||t.message.includes("verify your email")?a("Please verify your email before signing in. Check your inbox for the confirmation link."):a(t.message),l(!1)):(l(!1),g?.())}else{const t=setTimeout(()=>{l(!1),a("Signup is taking longer than expected. Please try again.")},15e3);try{const{error:i}=await y(s.email,s.password,{full_name:s.full_name||null,phone:s.phone||null,department:s.department||null,student_id:s.student_id||null});clearTimeout(t),i?(i.message.includes("security purposes")||i.message.includes("request this after")?a("Please wait a moment before trying again."):a(i.message),l(!1)):(a(null),I(s.email),N(!0),h({email:s.email,password:"",confirmPassword:"",full_name:"",phone:"",department:"",student_id:""}),setTimeout(()=>{x()},100),l(!1))}catch(i){clearTimeout(t),a("An unexpected error occurred during signup"),console.error("Signup error:",i),l(!1)}}}catch(t){a("An unexpected error occurred"),console.error("Auth error:",t)}finally{l(!1)}}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-background to-muted/20",children:[e.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:e.jsxs(O,{className:"shadow-2xl border-0 backdrop-blur-sm bg-card/80",children:[e.jsx(U,{className:"text-center pb-6",children:e.jsxs(C.div,{initial:{scale:.9},animate:{scale:1},transition:{delay:.1,duration:.3},children:[e.jsx(G,{className:"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:r==="login"?"Welcome Back":"Join Team Blitzer"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:r==="login"?"Sign in to access your dashboard":"Create your account to get started"})]})}),e.jsxs(V,{children:[e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[b&&e.jsx(E,{variant:"destructive",children:e.jsx(D,{children:b})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"email",name:"email",type:"email",placeholder:"your.email@cuet.ac.bd",value:s.email,onChange:o,className:"pl-10",required:!0})]})]}),r==="signup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"full_name",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"full_name",name:"full_name",type:"text",placeholder:"Your Full Name",value:s.full_name,onChange:o,className:"pl-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"student_id",children:"Student ID"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"student_id",name:"student_id",type:"text",placeholder:"22xxxxx",value:s.student_id,onChange:o,className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"department",children:"Department"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"department",name:"department",type:"text",placeholder:"ME, EEE, CSE...",value:s.department,onChange:o,className:"pl-10"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone",children:"Phone Number (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"phone",name:"phone",type:"tel",placeholder:"+880 1XXXXXXXXX",value:s.phone,onChange:o,className:"pl-10"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"password",name:"password",type:u?"text":"password",placeholder:"Enter your password",value:s.password,onChange:o,className:"pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>p(!u),className:"absolute right-3 top-3 h-4 w-4 text-muted-foreground hover:text-foreground",children:u?e.jsx(ee,{className:"h-4 w-4"}):e.jsx(se,{className:"h-4 w-4"})})]})]}),r==="signup"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",placeholder:"Confirm your password",value:s.confirmPassword,onChange:o,className:"pl-10",required:!0})]})]}),e.jsx(k,{type:"submit",className:"w-full",disabled:v||m,children:v||m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r==="login"?"Signing In...":"Creating Account..."]}):r==="login"?"Sign In":"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r==="login"?"Don't have an account?":"Already have an account?"," ",e.jsx("button",{type:"button",onClick:x,className:"text-primary hover:underline font-medium",children:r==="login"?"Sign Up":"Sign In"})]})})]})]})}),e.jsx(Y,{open:A,onOpenChange:N,children:e.jsxs(R,{className:"sm:max-w-md",children:[e.jsxs(W,{children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"h-8 w-8 text-green-600 dark:text-green-400"})})}),e.jsx(J,{className:"text-center text-xl",children:"Account Created Successfully!"}),e.jsxs(K,{className:"text-center pt-2",children:["We've sent a confirmation email to ",e.jsx("strong",{children:F})]})]}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"Please check your email inbox and click the confirmation link to verify your account before signing in."}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-foreground",children:"Next Steps:"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Check your email inbox (and spam folder)"}),e.jsx("li",{children:"Click the confirmation link in the email"}),e.jsx("li",{children:"Return here to sign in with your email and password"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Note:"})," You must verify your email before you can sign in. If you don't see the email, check your spam folder."]})})]}),e.jsx(Q,{children:e.jsx(k,{onClick:()=>{N(!1)},className:"w-full",children:"Got it! Sign In Now"})})]})})]})},xe=()=>{const{user:r,loading:x,session:g}=P(),[j,y]=n.useState("login"),[m]=L(),[s,h]=n.useState(!1);if(n.useEffect(()=>{(m.get("type")==="signup"||m.get("token"))&&(h(!0),window.history.replaceState({},"","/auth"),setTimeout(()=>h(!1),5e3))},[m]),x)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})});if(r&&g)return e.jsx(q,{to:"/dashboard",replace:!0});const u=()=>{y(p=>p==="login"?"signup":"login")};return e.jsxs("div",{children:[s&&e.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-md px-4",children:e.jsxs(E,{className:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",children:[e.jsx(_,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),e.jsx(D,{className:"text-green-800 dark:text-green-200",children:"Email verified successfully! You can now sign in."})]})}),e.jsx(ae,{mode:j,onToggleMode:u,onSuccess:()=>{}})]})};export{xe as default};
